/*!
 * async
 * https://github.com/caolan/async
 *
 * Copyright 2010-2014 Caolan McMahon
 * Released under the MIT license
 */
(function(){var g={};var r,l;r=this;if(r!=null){l=r.async}g.noConflict=function(){r.async=l;return g};function t(y){var x=false;return function(){if(x){throw new Error("Callback was already called.")}x=true;y.apply(r,arguments)}}var p=Object.prototype.toString;var i=Array.isArray||function(x){return p.call(x)==="[object Array]"};var u=function(x,z){for(var y=0;y<x.length;y+=1){z(x[y],y,x)}};var a=function(x,z){if(x.map){return x.map(z)}var y=[];u(x,function(A,C,B){y.push(z(A,C,B))});return y};var w=function(x,z,y){if(x.reduce){return x.reduce(z,y)}u(x,function(A,C,B){y=z(y,A,C,B)});return y};var d=function(z){if(Object.keys){return Object.keys(z)}var y=[];for(var x in z){if(z.hasOwnProperty(x)){y.push(x)}}return y};if(typeof process==="undefined"||!(process.nextTick)){if(typeof setImmediate==="function"){g.nextTick=function(x){setImmediate(x)};g.setImmediate=g.nextTick}else{g.nextTick=function(x){setTimeout(x,0)};g.setImmediate=g.nextTick}}else{g.nextTick=process.nextTick;if(typeof setImmediate!=="undefined"){g.setImmediate=function(x){setImmediate(x)}}else{g.setImmediate=g.nextTick}}g.each=function(x,A,B){B=B||function(){};if(!x.length){return B()}var z=0;u(x,function(C){A(C,t(y))});function y(C){if(C){B(C);B=function(){}}else{z+=1;if(z>=x.length){B()}}}};g.forEach=g.each;g.eachSeries=function(x,A,B){B=B||function(){};if(!x.length){return B()}var z=0;var y=function(){A(x[z],function(C){if(C){B(C);B=function(){}}else{z+=1;if(z>=x.length){B()}else{y()}}})};y()};g.forEachSeries=g.eachSeries;g.eachLimit=function(x,y,A,B){var z=f(y);z.apply(null,[x,A,B])};g.forEachLimit=g.eachLimit;var f=function(x){return function(y,B,D){D=D||function(){};if(!y.length||x<=0){return D()}var A=0;var C=0;var z=0;(function E(){if(A>=y.length){return D()}while(z<x&&C<y.length){C+=1;z+=1;B(y[C-1],function(F){if(F){D(F);D=function(){}}else{A+=1;z-=1;if(A>=y.length){D()}else{E()}}})}})()}};var s=function(x){return function(){var y=Array.prototype.slice.call(arguments);return x.apply(null,[g.each].concat(y))}};var q=function(x,y){return function(){var z=Array.prototype.slice.call(arguments);return y.apply(null,[f(x)].concat(z))}};var n=function(x){return function(){var y=Array.prototype.slice.call(arguments);return x.apply(null,[g.eachSeries].concat(y))}};var b=function(y,x,A,B){x=a(x,function(C,D){return{index:D,value:C}});if(!B){y(x,function(C,D){A(C.value,function(E){D(E)})})}else{var z=[];y(x,function(C,D){A(C.value,function(F,E){z[C.index]=E;D(F)})},function(C){B(C,z)})}};g.map=s(b);g.mapSeries=n(b);g.mapLimit=function(x,y,z,A){return e(y)(x,z,A)};var e=function(x){return q(x,b)};g.reduce=function(x,y,z,A){g.eachSeries(x,function(B,C){z(y,B,function(E,D){y=D;C(E)})},function(B){A(B,y)})};g.inject=g.reduce;g.foldl=g.reduce;g.reduceRight=function(x,y,z,A){var B=a(x,function(C){return C}).reverse();g.reduce(B,y,z,A)};g.foldr=g.reduceRight;var v=function(y,x,A,B){var z=[];x=a(x,function(C,D){return{index:D,value:C}});y(x,function(C,D){A(C.value,function(E){if(E){z.push(C)}D()})},function(C){B(a(z.sort(function(E,D){return E.index-D.index}),function(D){return D.value}))})};g.filter=s(v);g.filterSeries=n(v);g.select=g.filter;g.selectSeries=g.filterSeries;var m=function(y,x,A,B){var z=[];x=a(x,function(C,D){return{index:D,value:C}});y(x,function(C,D){A(C.value,function(E){if(!E){z.push(C)}D()})},function(C){B(a(z.sort(function(E,D){return E.index-D.index}),function(D){return D.value}))})};g.reject=s(m);g.rejectSeries=n(m);var h=function(y,x,z,A){y(x,function(B,C){z(B,function(D){if(D){A(B);A=function(){}}else{C()}})},function(B){A()})};g.detect=s(h);g.detectSeries=n(h);g.some=function(x,y,z){g.each(x,function(A,B){y(A,function(C){if(C){z(true);z=function(){}}B()})},function(A){z(false)})};g.any=g.some;g.every=function(x,y,z){g.each(x,function(A,B){y(A,function(C){if(!C){z(false);z=function(){}}B()})},function(A){z(true)})};g.all=g.every;g.sortBy=function(x,y,z){g.map(x,function(A,B){y(A,function(C,D){if(C){B(C)}else{B(null,{value:A,criteria:D})}})},function(C,A){if(C){return z(C)}else{var B=function(G,F){var E=G.criteria,D=F.criteria;return E<D?-1:E>D?1:0};z(null,a(A.sort(B),function(D){return D.value}))}})};g.auto=function(B,E){E=E||function(){};var F=d(B);var A=F.length;if(!A){return E()}var C={};var x=[];var y=function(G){x.unshift(G)};var z=function(H){for(var G=0;G<x.length;G+=1){if(x[G]===H){x.splice(G,1);return}}};var D=function(){A--;u(x.slice(0),function(G){G()})};y(function(){if(!A){var G=E;E=function(){};G(null,C)}});u(F,function(I){var H=i(B[I])?B[I]:[B[I]];var L=function(O){var M=Array.prototype.slice.call(arguments,1);if(M.length<=1){M=M[0]}if(O){var N={};u(d(C),function(P){N[P]=C[P]});N[I]=M;E(O,N);E=function(){}}else{C[I]=M;g.setImmediate(D)}};var G=H.slice(0,Math.abs(H.length-1))||[];var J=function(){return w(G,function(N,M){return(N&&C.hasOwnProperty(M))},true)&&!C.hasOwnProperty(I)};if(J()){H[H.length-1](L,C)}else{var K=function(){if(J()){z(K);H[H.length-1](L,C)}};y(K)}})};g.retry=function(C,x,B){var z=5;var y=[];if(typeof C==="function"){B=x;x=C;C=z}C=parseInt(C,10)||z;var A=function(F,D){var E=function(G,H){return function(I){G(function(J,K){I(!J||H,{err:J,result:K})},D)}};while(C){y.push(E(x,!(C-=1)))}g.series(y,function(G,H){H=H[H.length-1];(F||B)(H.err,H.result)})};return B?A():A};g.waterfall=function(A,z){z=z||function(){};if(!i(A)){var x=new Error("First argument to waterfall must be an array of functions");return z(x)}if(!A.length){return z()}var y=function(B){return function(E){if(E){z.apply(null,arguments);z=function(){}}else{var C=Array.prototype.slice.call(arguments,1);var D=B.next();if(D){C.push(y(D))}else{C.push(z)}g.setImmediate(function(){B.apply(null,C)})}}};y(g.iterator(A))()};var c=function(x,A,z){z=z||function(){};if(i(A)){x.map(A,function(B,C){if(B){B(function(E){var D=Array.prototype.slice.call(arguments,1);if(D.length<=1){D=D[0]}C.call(null,E,D)})}},z)}else{var y={};x.each(d(A),function(B,C){A[B](function(E){var D=Array.prototype.slice.call(arguments,1);if(D.length<=1){D=D[0]}y[B]=D;C(E)})},function(B){z(B,y)})}};g.parallel=function(y,x){c({map:g.map,each:g.each},y,x)};g.parallelLimit=function(z,x,y){c({map:e(x),each:f(x)},z,y)};g.series=function(z,y){y=y||function(){};if(i(z)){g.mapSeries(z,function(A,B){if(A){A(function(D){var C=Array.prototype.slice.call(arguments,1);if(C.length<=1){C=C[0]}B.call(null,D,C)})}},y)}else{var x={};g.eachSeries(d(z),function(A,B){z[A](function(D){var C=Array.prototype.slice.call(arguments,1);if(C.length<=1){C=C[0]}x[A]=C;B(D)})},function(A){y(A,x)})}};g.iterator=function(y){var x=function(z){var A=function(){if(y.length){y[z].apply(null,arguments)}return A.next()};A.next=function(){return(z<y.length-1)?x(z+1):null};return A};return x(0)};g.apply=function(y){var x=Array.prototype.slice.call(arguments,1);return function(){return y.apply(null,x.concat(Array.prototype.slice.call(arguments)))}};var o=function(y,x,z,B){var A=[];y(x,function(D,C){z(D,function(E,F){A=A.concat(F||[]);C(E)})},function(C){B(C,A)})};g.concat=s(o);g.concatSeries=n(o);g.whilst=function(z,x,y){if(z()){x(function(A){if(A){return y(A)}g.whilst(z,x,y)})}else{y()}};g.doWhilst=function(x,z,y){x(function(B){if(B){return y(B)}var A=Array.prototype.slice.call(arguments,1);if(z.apply(null,A)){g.doWhilst(x,z,y)}else{y()}})};g.until=function(z,x,y){if(!z()){x(function(A){if(A){return y(A)}g.until(z,x,y)})}else{y()}};g.doUntil=function(x,z,y){x(function(B){if(B){return y(B)}var A=Array.prototype.slice.call(arguments,1);if(!z.apply(null,A)){g.doUntil(x,z,y)}else{y()}})};g.queue=function(B,z){if(z===undefined){z=1}function x(D,C,F,E){if(!D.started){D.started=true}if(!i(C)){C=[C]}if(C.length==0){return g.setImmediate(function(){if(D.drain){D.drain()}})}u(C,function(G){var H={data:G,callback:typeof E==="function"?E:null};if(F){D.tasks.unshift(H)}else{D.tasks.push(H)}if(D.saturated&&D.tasks.length===D.concurrency){D.saturated()}g.setImmediate(D.process)})}var y=0;var A={tasks:[],concurrency:z,saturated:null,empty:null,drain:null,started:false,paused:false,push:function(C,D){x(A,C,false,D)},kill:function(){A.drain=null;A.tasks=[]},unshift:function(C,D){x(A,C,true,D)},process:function(){if(!A.paused&&y<A.concurrency&&A.tasks.length){var D=A.tasks.shift();if(A.empty&&A.tasks.length===0){A.empty()}y+=1;var E=function(){y-=1;if(D.callback){D.callback.apply(D,arguments)}if(A.drain&&A.tasks.length+y===0){A.drain()}A.process()};var C=t(E);B(D.data,C)}},length:function(){return A.tasks.length},running:function(){return y},idle:function(){return A.tasks.length+y===0},pause:function(){if(A.paused===true){return}A.paused=true},resume:function(){if(A.paused===false){return}A.paused=false;for(var C=1;C<=A.concurrency;C++){g.setImmediate(A.process)}}};return A};g.priorityQueue=function(C,z){function y(E,D){return E.priority-D.priority}function A(I,G,H){var F=-1,D=I.length-1;while(F<D){var E=F+((D-F+1)>>>1);if(H(G,I[E])>=0){F=E}else{D=E-1}}return F}function x(F,E,D,G){if(!F.started){F.started=true}if(!i(E)){E=[E]}if(E.length==0){return g.setImmediate(function(){if(F.drain){F.drain()}})}u(E,function(H){var I={data:H,priority:D,callback:typeof G==="function"?G:null};F.tasks.splice(A(F.tasks,I,y)+1,0,I);if(F.saturated&&F.tasks.length===F.concurrency){F.saturated()}g.setImmediate(F.process)})}var B=g.queue(C,z);B.push=function(E,D,F){x(B,E,D,F)};delete B.unshift;return B};g.cargo=function(z,C){var x=false,B=[];var y={tasks:B,payload:C,saturated:null,empty:null,drain:null,drained:true,push:function(D,E){if(!i(D)){D=[D]}u(D,function(F){B.push({data:F,callback:typeof E==="function"?E:null});y.drained=false;if(y.saturated&&B.length===C){y.saturated()}});g.setImmediate(y.process)},process:function A(){if(x){return}if(B.length===0){if(y.drain&&!y.drained){y.drain()}y.drained=true;return}var D=typeof C==="number"?B.splice(0,C):B.splice(0,B.length);var E=a(D,function(F){return F.data});if(y.empty){y.empty()}x=true;z(E,function(){x=false;var F=arguments;u(D,function(G){if(G.callback){G.callback.apply(null,F)}});A()})},length:function(){return B.length},running:function(){return x}};return y};var j=function(x){return function(z){var y=Array.prototype.slice.call(arguments,1);z.apply(null,y.concat([function(B){var A=Array.prototype.slice.call(arguments,1);if(typeof console!=="undefined"){if(B){if(console.error){console.error(B)}}else{if(console[x]){u(A,function(C){console[x](C)})}}}}]))}};g.log=j("log");g.dir=j("dir");g.memoize=function(B,z){var y={};var x={};z=z||function(C){return C};var A=function(){var C=Array.prototype.slice.call(arguments);var E=C.pop();var D=z.apply(null,C);if(D in y){g.nextTick(function(){E.apply(null,y[D])})}else{if(D in x){x[D].push(E)}else{x[D]=[E];B.apply(null,C.concat([function(){y[D]=arguments;var H=x[D];delete x[D];for(var G=0,F=H.length;G<F;G++){H[G].apply(null,arguments)}}]))}}};A.memo=y;A.unmemoized=B;return A};g.unmemoize=function(x){return function(){return(x.unmemoized||x).apply(null,arguments)}};g.times=function(A,z,B){var x=[];for(var y=0;y<A;y++){x.push(y)}return g.map(x,z,B)};g.timesSeries=function(A,z,B){var x=[];for(var y=0;y<A;y++){x.push(y)}return g.mapSeries(x,z,B)};g.seq=function(){var x=arguments;return function(){var z=this;var y=Array.prototype.slice.call(arguments);var A=y.pop();g.reduce(x,y,function(C,D,B){D.apply(z,C.concat([function(){var F=arguments[0];var E=Array.prototype.slice.call(arguments,1);B(F,E)}]))},function(C,B){A.apply(z,[C].concat(B))})}};g.compose=function(){return g.seq.apply(null,Array.prototype.reverse.call(arguments))};var k=function(x,z){var A=function(){var C=this;var B=Array.prototype.slice.call(arguments);var D=B.pop();return x(z,function(F,E){F.apply(C,B.concat([E]))},D)};if(arguments.length>2){var y=Array.prototype.slice.call(arguments,2);return A.apply(this,y)}else{return A}};g.applyEach=s(k);g.applyEachSeries=n(k);g.forever=function(y,z){function x(A){if(A){if(z){return z(A)}throw A}y(x)}x()};if(typeof module!=="undefined"&&module.exports){module.exports=g}else{if(typeof define!=="undefined"&&define.amd){define([],function(){return g})}else{r.async=g}}}());